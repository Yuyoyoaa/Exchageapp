This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
src/
  components/
    Login.vue
    Register.vue
  router/
    index.ts
  store/
    auth.ts
  types/
    Article.d.ts
    User.d.ts
  views/
    AdminArticleView.vue
    AdminUserView.vue
    CurrencyExchangeView.vue
    HomeView.vue
    NewsDetailView.vue
    NewsView.vue
    ProfileView.vue
  App.vue
  axios.ts
  main.ts
  shims-vue.d.ts
  vite-env.d.ts
__VLS_types.d.ts
index.html
package.json
tsconfig.json
tsconfig.node.json
vite.config.ts
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="src/components/Login.vue">
<template>  
  <div class="auth-container">  
    <el-form :model="form" class="auth-form" label-position="top" @submit.prevent="login">  
      <h2 style="text-align: center; margin-bottom: 20px;">ç”¨æˆ·ç™»å½•</h2>
      <el-form-item label="ç”¨æˆ·å">  
        <el-input v-model="form.username" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" />  
      </el-form-item>  
      <el-form-item label="å¯†ç ">  
        <el-input v-model="form.password" type="password" placeholder="è¯·è¾“å…¥å¯†ç " show-password />  
      </el-form-item>  
      <el-form-item>  
        <el-button type="primary" native-type="submit" style="width: 100%" :loading="loading">ç™»å½•</el-button>  
      </el-form-item>  
    </el-form>  
  </div>  
</template>  
  
<script setup lang="ts">
import { ElMessage } from 'element-plus';
import { ref } from 'vue';
import { useRouter } from 'vue-router';
import { useAuthStore } from '../store/auth';

const form = ref({
  username: '',
  password: '',
});

const loading = ref(false);
const authStore = useAuthStore();
const router = useRouter();

const login = async () => {
  loading.value = true;
  try {
    await authStore.login(form.value.username, form.value.password);
    ElMessage.success('ç™»å½•æˆåŠŸ');
    router.push({ name: 'News' });
  } catch (error: any) {
    // è¿™é‡Œçš„ error.message å·²ç»æ˜¯ store ä¸­å¤„ç†è¿‡çš„åç«¯ error å­—æ®µ
    ElMessage.error(error.message || 'ç™»å½•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–é‡è¯•ã€‚');
  } finally {
    loading.value = false;
  }
};
</script>
  
<style scoped>
.auth-container {  
  display: flex;  
  justify-content: center;  
  align-items: center;  
  height: 80vh; 
  background-color: #f5f5f5; 
  padding: 20px;  
  box-sizing: border-box; 
}  
  
.auth-form {  
  width: 100%;  
  max-width: 360px; 
  padding: 30px;  
  background-color: #fff;  
  border-radius: 8px;  
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);  
}  
</style>
</file>

<file path="src/components/Register.vue">
<template>
  <div class="auth-container">
    <el-form :model="form" class="auth-form" label-position="top" @submit.prevent="register">
      <h2 style="text-align: center; margin-bottom: 20px;">ç”¨æˆ·æ³¨å†Œ</h2>
      
      <el-form-item label="ç”¨æˆ·å (å¿…å¡«)" required>
        <el-input v-model="form.username" placeholder="å”¯ä¸€ç”¨æˆ·å" />
      </el-form-item>
      
      <el-form-item label="å¯†ç  (å¿…å¡«)" required>
        <el-input v-model="form.password" type="password" placeholder="8ä½ä»¥ä¸Šï¼Œå«å¤§å°å†™å­—æ¯å’Œæ•°å­—" show-password />
      </el-form-item>

      <el-form-item label="æ˜µç§°">
        <el-input v-model="form.nickname" placeholder="æ‚¨çš„æ˜µç§°" />
      </el-form-item>

      <el-form-item label="é‚®ç®±">
        <el-input v-model="form.email" placeholder="example@email.com" />
      </el-form-item>

      <el-form-item label="å¤´åƒ URL">
        <el-input v-model="form.avatar" placeholder="https://example.com/avatar.png" />
      </el-form-item>

      <el-button type="primary" native-type="submit" style="width: 100%" :loading="loading">æ³¨å†Œ</el-button>
    </el-form>
  </div>
</template>

<script setup lang="ts">
import { ElMessage } from 'element-plus';
import { ref } from 'vue';
import { useRouter } from 'vue-router';
import { useAuthStore } from '../store/auth';

const form = ref({
  username: '',
  password: '',
  nickname: '',
  email: '',
  avatar: ''
});

const loading = ref(false);
const authStore = useAuthStore();
const router = useRouter();

const register = async () => {
  if (!form.value.username || !form.value.password) {
    ElMessage.warning('ç”¨æˆ·åå’Œå¯†ç æ˜¯å¿…å¡«é¡¹');
    return;
  }

  loading.value = true;
  try {
    await authStore.register({
      username: form.value.username,
      password: form.value.password,
      nickname: form.value.nickname || undefined,
      email: form.value.email || undefined,
      avatar: form.value.avatar || undefined
    });
    ElMessage.success('æ³¨å†ŒæˆåŠŸï¼');
    router.push({ name: 'News' });
  } catch (error: any) {
    ElMessage.error(error.message || 'æ³¨å†Œå¤±è´¥ï¼Œè¯·é‡è¯•ã€‚');
  } finally {
    loading.value = false;
  }
};
</script>

<style scoped>
.auth-container {  
  display: flex;  
  justify-content: center;  
  align-items: center;  
  min-height: 80vh; 
  background-color: #f5f5f5; 
  padding: 20px;  
  box-sizing: border-box; 
}  
  
.auth-form {  
  width: 100%;  
  max-width: 400px; 
  padding: 30px;  
  background-color: #fff;  
  border-radius: 8px;  
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);  
}  
</style>
</file>

<file path="src/router/index.ts">
import { createRouter, createWebHistory, RouteRecordRaw } from 'vue-router';
import Login from '../components/Login.vue';
import Register from '../components/Register.vue';
import { useAuthStore } from '../store/auth';
import AdminArticleView from '../views/AdminArticleView.vue'; // æ–°å¢ï¼šå¼•å…¥æ–‡ç« ç®¡ç†é¡µé¢
import AdminUserView from '../views/AdminUserView.vue';
import CurrencyExchangeView from '../views/CurrencyExchangeView.vue';
import HomeView from '../views/HomeView.vue';
import NewsDetailView from '../views/NewsDetailView.vue';
import NewsView from '../views/NewsView.vue';
import ProfileView from '../views/ProfileView.vue';

const routes: RouteRecordRaw[] = [
  { path: '/', name: 'Home', component: HomeView },
  { path: '/exchange', name: 'CurrencyExchange', component: CurrencyExchangeView },
  { path: '/news', name: 'News', component: NewsView },
  { path: '/news/:id', name: 'NewsDetail', component: NewsDetailView },
  { path: '/login', name: 'Login', component: Login },
  { path: '/register', name: 'Register', component: Register },
  { 
    path: '/profile', 
    name: 'Profile', 
    component: ProfileView, 
    meta: { requiresAuth: true } 
  },
  { 
    path: '/admin/users', 
    name: 'AdminUsers', 
    component: AdminUserView, 
    meta: { requiresAuth: true, requiresAdmin: true } 
  },
  { 
    path: '/admin/articles', 
    name: 'AdminArticles', 
    component: AdminArticleView, // æ–°å¢ï¼šæ–‡ç« ç®¡ç†è·¯ç”±
    meta: { requiresAuth: true, requiresAdmin: true } 
  },
];

const router = createRouter({
  history: createWebHistory(),
  routes,
});

router.beforeEach(async (to, from, next) => {
  const authStore = useAuthStore();
  
  // æ£€æŸ¥æ˜¯å¦éœ€è¦ç™»å½•
  if (to.meta.requiresAuth && !authStore.isAuthenticated) {
    next('/login');
    return;
  }
  
  // æ£€æŸ¥æ˜¯å¦éœ€è¦ç®¡ç†å‘˜æƒé™
  if (to.meta.requiresAdmin) {
    if (!authStore.isAuthenticated) {
      next('/login');
      return;
    }
    
    // ç¡®ä¿ç”¨æˆ·ä¿¡æ¯å·²åŠ è½½
    if (!authStore.user) {
      try {
        await authStore.fetchProfile();
      } catch (error) {
        next('/login');
        return;
      }
    }
    
    // æ£€æŸ¥ç®¡ç†å‘˜æƒé™
    if (authStore.user?.role !== 'admin') {
      next('/');
      return;
    }
  }
  
  next();
});

export default router;
</file>

<file path="src/store/auth.ts">
// FrontEnd/src/store/auth.ts
import { defineStore } from 'pinia';
import { computed, ref } from 'vue';
import axios from '../axios';

export interface User {
  ID: number;
  username: string;
  role: string;
  nickname: string;
  email: string;
  avatar: string;
  CreatedAt?: string;
  UpdatedAt?: string;
}

export interface RegisterPayload {
  username: string;
  password: string;
  nickname?: string;
  email?: string;
  avatar?: string;
}

export interface UpdateProfilePayload {
  nickname?: string;
  email?: string;
  avatar?: string;
  password?: string;
}

export const useAuthStore = defineStore('auth', () => {
  const token = ref<string | null>(localStorage.getItem('token'));
  const user = ref<User | null>(null);

  const isAuthenticated = computed(() => !!token.value);

  const fetchProfile = async () => {
    if (!token.value) return;
    try {
      const response = await axios.get<User>('/user/profile');
      user.value = response.data;
    } catch (error) {
      console.error('Failed to fetch profile', error);
      throw error;
    }
  };

  const login = async (username: string, password: string) => {
    try {
      const response = await axios.post('/auth/login', { username, password });
      token.value = response.data.token;
      localStorage.setItem('token', token.value || '');
      await fetchProfile();
    } catch (error: any) {
      if (error.response?.data?.error) {
        throw new Error(error.response.data.error);
      }
      throw error;
    }
  };

  const register = async (payload: RegisterPayload) => {
    try {
      const response = await axios.post('/auth/register', payload);
      token.value = response.data.token;
      localStorage.setItem('token', token.value || '');
      if (response.data.user) {
        user.value = response.data.user;
      }
    } catch (error: any) {
      if (error.response?.data?.error) {
        throw new Error(error.response.data.error);
      }
      throw error;
    }
  };

  const updateProfile = async (payload: UpdateProfilePayload) => {
    try {
      const response = await axios.put<User>('/user/profile', payload);
      user.value = response.data;
      return response.data;
    } catch (error: any) {
      if (error.response?.data?.error) {
        throw new Error(error.response.data.error);
      }
      throw error;
    }
  };

  const logout = () => {
    token.value = null;
    user.value = null;
    localStorage.removeItem('token');
  };

  const checkAdminPermission = async (): Promise<boolean> => {
    if (!user.value) {
      await fetchProfile();
    }
    return user.value?.role === 'admin';
  };

  return {
    token,
    user,
    isAuthenticated,
    login,
    register,
    fetchProfile,
    updateProfile,
    logout,
    checkAdminPermission
  };
});
</file>

<file path="src/types/Article.d.ts">
export interface Article {
  ID: number;
  Title: string;
  Content: string;
  Preview: string;
  Cover?: string;
  LikesCount: number;
  ViewsCount: number;
  AuthorID: number;
  CategoryID?: number;
  Status: string;
  CreatedAt?: string;
  UpdatedAt?: string;
}

export interface Comment {
  ID: number;
  ArticleID: number;
  UserID: number;
  UserName: string;
  Content: string;
  ParentID?: number;
  CreatedAt?: string;
}

export interface Category {
  ID: number;
  Name: string;
}

export interface LikeResponse {
  message: string;
  likesCount: number;
}
</file>

<file path="src/types/User.d.ts">
export interface User {
  ID: number; // ç¡®ä¿ä¸åç«¯ uint ç±»å‹å…¼å®¹
  username: string;
  nickname: string;
  email: string;
  role: string;
  avatar: string;
  CreatedAt: string;
  UpdatedAt?: string;
}

export interface AdminUserListResponse {
  users: User[];
  total: number;
}

export interface ChangeRoleRequest {
  role: 'admin' | 'user';
}

export interface ChangeRoleResponse {
  message: string;
  user_id: number;
  new_role: string;
}
</file>

<file path="src/views/AdminArticleView.vue">
<template>
  <el-container class="admin-container">
    <el-card class="admin-card">
      <template #header>
        <div class="card-header">
          <h2>æ–‡ç« ä¸åˆ†ç±»ç®¡ç†</h2>
          <div class="header-actions">
            <el-button type="success" @click="categoryDialogVisible = true">ç®¡ç†åˆ†ç±»</el-button>
            <el-button type="primary" @click="openCreateDialog">å‘å¸ƒæ–‡ç« </el-button>
          </div>
        </div>
      </template>

      <el-table :data="articles" v-loading="loading" stripe style="width: 100%">
        <el-table-column prop="ID" label="ID" width="60" />
        <el-table-column prop="Title" label="æ ‡é¢˜" show-overflow-tooltip />
        <el-table-column label="åˆ†ç±»" width="120">
          <template #default="scope">
            <el-tag size="small">{{ getCategoryName(scope.row.CategoryID) }}</el-tag>
          </template>
        </el-table-column>
        <el-table-column prop="ViewsCount" label="æµè§ˆ" width="80" />
        <el-table-column prop="CreatedAt" label="å‘å¸ƒæ—¶é—´" width="160">
          <template #default="scope">
            {{ formatDate(scope.row.CreatedAt) }}
          </template>
        </el-table-column>
        <el-table-column label="æ“ä½œ" width="180">
          <template #default="scope">
            <el-button size="small" @click="handleEdit(scope.row)">ç¼–è¾‘</el-button>
            <el-button size="small" type="danger" @click="handleDelete(scope.row)">åˆ é™¤</el-button>
          </template>
        </el-table-column>
      </el-table>

      <div class="pagination">
         <el-pagination layout="prev, pager, next" :total="100" /> </div>
    </el-card>

    <el-dialog v-model="dialogVisible" :title="isEdit ? 'ç¼–è¾‘æ–‡ç« ' : 'å‘å¸ƒæ–‡ç« '" width="700px">
      <el-form :model="form" label-width="80px">
        <el-form-item label="æ ‡é¢˜">
          <el-input v-model="form.title" placeholder="è¯·è¾“å…¥æ–‡ç« æ ‡é¢˜" />
        </el-form-item>
        <el-form-item label="åˆ†ç±»">
          <el-select v-model="form.categoryId" placeholder="é€‰æ‹©åˆ†ç±»" style="width: 100%">
            <el-option v-for="c in categories" :key="c.ID" :label="c.Name" :value="c.ID" />
          </el-select>
        </el-form-item>
        <el-form-item label="å°é¢URL">
          <el-input v-model="form.cover" placeholder="å›¾ç‰‡åœ°å€" />
        </el-form-item>
        <el-form-item label="ç®€ä»‹">
          <el-input v-model="form.preview" type="textarea" :rows="2" placeholder="æ–‡ç« é¢„è§ˆæ–‡å­—" />
        </el-form-item>
        <el-form-item label="å†…å®¹">
          <el-input v-model="form.content" type="textarea" :rows="10" placeholder="æ”¯æŒ HTML å†…å®¹" />
        </el-form-item>
      </el-form>
      <template #footer>
        <el-button @click="dialogVisible = false">å–æ¶ˆ</el-button>
        <el-button type="primary" @click="submitArticle">æäº¤</el-button>
      </template>
    </el-dialog>

    <el-dialog v-model="categoryDialogVisible" title="åˆ†ç±»ç®¡ç†" width="500px">
      <div class="category-input">
        <el-input v-model="newCategoryName" placeholder="æ–°åˆ†ç±»åç§°" />
        <el-button type="primary" @click="addCategory" :disabled="!newCategoryName">æ·»åŠ </el-button>
      </div>
      <el-table :data="categories" height="300px">
        <el-table-column prop="ID" label="ID" width="60" />
        <el-table-column prop="Name" label="åç§°" />
        <el-table-column label="æ“ä½œ" width="100">
          <template #default="scope">
            <el-button type="danger" link @click="deleteCategory(scope.row.ID)">åˆ é™¤</el-button>
          </template>
        </el-table-column>
      </el-table>
    </el-dialog>

  </el-container>
</template>

<script setup lang="ts">
import { ElMessage, ElMessageBox } from 'element-plus';
import { onMounted, reactive, ref } from 'vue';
import axios from '../axios';

const articles = ref([]);
const categories = ref<any[]>([]);
const loading = ref(false);
const dialogVisible = ref(false);
const categoryDialogVisible = ref(false);
const isEdit = ref(false);
const currentId = ref<number | null>(null);

const form = reactive({
  title: '',
  content: '',
  preview: '',
  cover: '',
  categoryId: null as number | null
});

const newCategoryName = ref('');

const fetchData = async () => {
  loading.value = true;
  try {
    const [artRes, catRes] = await Promise.all([
      axios.get('/articles?limit=100'), // Get all for admin demo
      axios.get('/categories')
    ]);
    articles.value = artRes.data;
    categories.value = catRes.data;
  } catch (e) {
    ElMessage.error('åŠ è½½æ•°æ®å¤±è´¥');
  } finally {
    loading.value = false;
  }
};

const getCategoryName = (id: number) => {
  const cat = categories.value.find(c => c.ID === id);
  return cat ? cat.Name : 'æœªåˆ†ç±»';
};

const openCreateDialog = () => {
  isEdit.value = false;
  currentId.value = null;
  form.title = '';
  form.content = '';
  form.preview = '';
  form.cover = '';
  form.categoryId = null;
  dialogVisible.value = true;
};

const handleEdit = (row: any) => {
  isEdit.value = true;
  currentId.value = row.ID;
  form.title = row.Title;
  form.content = row.Content;
  form.preview = row.Preview;
  form.cover = row.Cover;
  form.categoryId = row.CategoryID;
  dialogVisible.value = true;
};

const submitArticle = async () => {
  try {
    const payload = {
      title: form.title,
      content: form.content,
      preview: form.preview,
      cover: form.cover,
      categoryId: form.categoryId,
      status: 'published'
    };

    if (isEdit.value && currentId.value) {
      await axios.put(`/admin/articles/${currentId.value}`, payload);
      ElMessage.success('æ›´æ–°æˆåŠŸ');
    } else {
      await axios.post('/admin/articles', payload);
      ElMessage.success('å‘å¸ƒæˆåŠŸ');
    }
    dialogVisible.value = false;
    fetchData();
  } catch (e: any) {
    ElMessage.error(e.response?.data?.error || 'æ“ä½œå¤±è´¥');
  }
};

const handleDelete = (row: any) => {
  ElMessageBox.confirm('ç¡®å®šè¦åˆ é™¤è¿™ç¯‡æ–‡ç« å—?', 'è­¦å‘Š', {
    confirmButtonText: 'åˆ é™¤',
    cancelButtonText: 'å–æ¶ˆ',
    type: 'warning',
  }).then(async () => {
    try {
      await axios.delete(`/admin/articles/${row.ID}`);
      ElMessage.success('åˆ é™¤æˆåŠŸ');
      fetchData();
    } catch (e) {
      ElMessage.error('åˆ é™¤å¤±è´¥');
    }
  });
};

const addCategory = async () => {
  try {
    await axios.post('/admin/categories', { name: newCategoryName.value });
    ElMessage.success('åˆ†ç±»æ·»åŠ æˆåŠŸ');
    newCategoryName.value = '';
    const res = await axios.get('/categories');
    categories.value = res.data;
  } catch (e: any) {
    ElMessage.error(e.response?.data?.error || 'æ·»åŠ å¤±è´¥');
  }
};

const deleteCategory = async (id: number) => {
  try {
    await axios.delete(`/admin/categories/${id}`);
    ElMessage.success('åˆ†ç±»å·²åˆ é™¤');
    const res = await axios.get('/categories');
    categories.value = res.data;
  } catch (e) {
    ElMessage.error('åˆ é™¤å¤±è´¥');
  }
};

const formatDate = (dateStr: string) => {
  if (!dateStr || dateStr.startsWith('0001')) return 'åˆšåˆš';
  return new Date(dateStr).toLocaleString();
};

onMounted(fetchData);
</script>

<style scoped>
.admin-container { padding: 20px; background-color: #f5f7fa; min-height: calc(100vh - 60px); }
.admin-card { max-width: 1200px; margin: 0 auto; }
.card-header { display: flex; justify-content: space-between; align-items: center; }
.header-actions { display: flex; gap: 10px; }
.pagination { margin-top: 20px; text-align: right; }
.category-input { display: flex; gap: 10px; margin-bottom: 20px; }
</style>
</file>

<file path="src/views/AdminUserView.vue">
<template>
  <el-container class="admin-container">
    <el-card class="admin-card">
      <template #header>
        <div class="card-header">
          <h2>ç”¨æˆ·ç®¡ç†</h2>
          <el-button type="primary" @click="refreshUsers">åˆ·æ–°</el-button>
        </div>
      </template>

      <el-table :data="users" v-loading="loading" style="width: 100%">
        <el-table-column prop="ID" label="ID" width="80" />
        <el-table-column prop="username" label="ç”¨æˆ·å" width="120" />
        <el-table-column prop="nickname" label="æ˜µç§°" width="120" />
        <el-table-column prop="email" label="é‚®ç®±" width="200" />
        <el-table-column prop="role" label="è§’è‰²" width="100">
          <template #default="scope">
            <el-tag :type="scope.row.role === 'admin' ? 'danger' : 'primary'">
              {{ scope.row.role === 'admin' ? 'ç®¡ç†å‘˜' : 'æ™®é€šç”¨æˆ·' }}
            </el-tag>
          </template>
        </el-table-column>
        <el-table-column prop="CreatedAt" label="æ³¨å†Œæ—¶é—´" width="180">
          <template #default="scope">
            {{ formatDate(scope.row.CreatedAt) }}
          </template>
        </el-table-column>
        <el-table-column label="æ“ä½œ" width="200">
          <template #default="scope">
            <el-button 
              size="small" 
              :type="scope.row.role === 'admin' ? 'warning' : 'success'"
              @click="handleChangeRole(scope.row)"
              :disabled="scope.row.username === authStore.user?.username"
            >
              {{ scope.row.role === 'admin' ? 'é™ä¸ºç”¨æˆ·' : 'è®¾ä¸ºç®¡ç†å‘˜' }}
            </el-button>
            <el-button 
              size="small" 
              type="danger" 
              @click="handleDeleteUser(scope.row)"
              :disabled="scope.row.username === authStore.user?.username"
            >
              åˆ é™¤
            </el-button>
          </template>
        </el-table-column>
      </el-table>
    </el-card>

    <!-- ä¿®æ”¹è§’è‰²ç¡®è®¤å¯¹è¯æ¡† -->
    <el-dialog v-model="roleDialogVisible" title="ä¿®æ”¹ç”¨æˆ·è§’è‰²" width="400px">
      <p>ç¡®å®šè¦å°†ç”¨æˆ· <strong>{{ selectedUser?.username }}</strong> çš„è§’è‰²ä¿®æ”¹ä¸º <strong>{{ selectedUser?.role === 'admin' ? 'æ™®é€šç”¨æˆ·' : 'ç®¡ç†å‘˜' }}</strong> å—ï¼Ÿ</p>
      <template #footer>
        <el-button @click="roleDialogVisible = false">å–æ¶ˆ</el-button>
        <el-button type="primary" @click="confirmChangeRole" :loading="roleLoading">ç¡®è®¤ä¿®æ”¹</el-button>
      </template>
    </el-dialog>

    <!-- åˆ é™¤ç”¨æˆ·ç¡®è®¤å¯¹è¯æ¡† -->
    <el-dialog v-model="deleteDialogVisible" title="åˆ é™¤ç”¨æˆ·" width="400px">
      <p style="color: #f56c6c;">è­¦å‘Šï¼šæ­¤æ“ä½œå°†æ°¸ä¹…åˆ é™¤ç”¨æˆ· <strong>{{ selectedUser?.username }}</strong>ï¼Œä¸”æ— æ³•æ¢å¤ï¼</p>
      <template #footer>
        <el-button @click="deleteDialogVisible = false">å–æ¶ˆ</el-button>
        <el-button type="danger" @click="confirmDeleteUser" :loading="deleteLoading">ç¡®è®¤åˆ é™¤</el-button>
      </template>
    </el-dialog>
  </el-container>
</template>

<script setup lang="ts">
import { ElMessage } from 'element-plus';
import { onMounted, ref } from 'vue';
import axios from '../axios';
import { useAuthStore } from '../store/auth';

interface User {
  ID: number;
  username: string;
  nickname: string;
  email: string;
  role: string;
  avatar: string;
  CreatedAt: string;
}

const authStore = useAuthStore();
const loading = ref(false);
const users = ref<User[]>([]);
const roleDialogVisible = ref(false);
const deleteDialogVisible = ref(false);
const selectedUser = ref<User | null>(null);
const roleLoading = ref(false);
const deleteLoading = ref(false);

const fetchUsers = async () => {
  loading.value = true;
  try {
    const response = await axios.get('/admin/users');
    users.value = response.data;
  } catch (error: any) {
    ElMessage.error('è·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥: ' + (error.response?.data?.error || error.message));
  } finally {
    loading.value = false;
  }
};

const refreshUsers = () => {
  fetchUsers();
};

const handleChangeRole = (user: User) => {
  selectedUser.value = user;
  roleDialogVisible.value = true;
};

const confirmChangeRole = async () => {
  if (!selectedUser.value) return;
  
  roleLoading.value = true;
  try {
    const newRole = selectedUser.value.role === 'admin' ? 'user' : 'admin';
    await axios.patch(`/admin/users/${selectedUser.value.ID}/role`, { role: newRole });
    ElMessage.success('è§’è‰²ä¿®æ”¹æˆåŠŸ');
    roleDialogVisible.value = false;
    await fetchUsers();
  } catch (error: any) {
    ElMessage.error('ä¿®æ”¹è§’è‰²å¤±è´¥: ' + (error.response?.data?.error || error.message));
  } finally {
    roleLoading.value = false;
  }
};

const handleDeleteUser = (user: User) => {
  selectedUser.value = user;
  deleteDialogVisible.value = true;
};

const confirmDeleteUser = async () => {
  if (!selectedUser.value) return;
  
  deleteLoading.value = true;
  try {
    await axios.delete(`/admin/users/${selectedUser.value.ID}`);
    ElMessage.success('ç”¨æˆ·åˆ é™¤æˆåŠŸ');
    deleteDialogVisible.value = false;
    await fetchUsers();
  } catch (error: any) {
    ElMessage.error('åˆ é™¤ç”¨æˆ·å¤±è´¥: ' + (error.response?.data?.error || error.message));
  } finally {
    deleteLoading.value = false;
  }
};

const formatDate = (dateString: string) => {
  if (!dateString) return '';
  return new Date(dateString).toLocaleString('zh-CN');
};

onMounted(() => {
  fetchUsers();
});
</script>

<style scoped>
.admin-container {
  padding: 20px;
  min-height: calc(100vh - 60px);
  background-color: #f5f7fa;
}

.admin-card {
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
}

.card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
</style>
</file>

<file path="src/views/CurrencyExchangeView.vue">
<template>  
  <el-container style="min-height: calc(100vh - 60px);">  
    <el-main>
      <el-card class="exchange-card">
        <template #header>
          <div class="card-header">
            <h2>è´§å¸å…‘æ¢</h2>
            <el-button type="primary" @click="fetchExchangeRates" :loading="loading">
              åˆ·æ–°æ±‡ç‡
            </el-button>
          </div>
        </template>

        <el-form :model="form" class="exchange-form">
          <el-row :gutter="20">
            <el-col :span="10">
              <el-form-item label="ä»è´§å¸" label-width="80px">
                <el-select v-model="form.fromCurrency" placeholder="é€‰æ‹©è´§å¸" style="width: 100%;">
                  <el-option v-for="c in currencies" :key="c" :value="c" :label="c" />
                </el-select>
              </el-form-item>
            </el-col>

            <el-col :span="10">
              <el-form-item label="åˆ°è´§å¸" label-width="80px">
                <el-select v-model="form.toCurrency" placeholder="é€‰æ‹©è´§å¸" style="width: 100%;">
                  <el-option v-for="c in currencies" :key="c" :value="c" :label="c" />
                </el-select>
              </el-form-item>
            </el-col>

            <el-col :span="4">
              <el-button type="success" style="width:100%;margin-top:32px" @click="swapCurrencies">
                â‡„ äº¤æ¢
              </el-button>
            </el-col>
          </el-row>

          <el-form-item label="é‡‘é¢" label-width="80px">
            <el-input v-model="form.amount" type="number" @input="calculateResult">
              <template #prepend>{{ form.fromCurrency }}</template>
            </el-input>
          </el-form-item>

          <el-form-item>
            <el-button type="primary" style="width:100%" @click="exchange">ç«‹å³å…‘æ¢</el-button>
          </el-form-item>
        </el-form>

        <!-- ç»“æœå±•ç¤º -->
        <div v-if="result !== null" class="result-panel">
          <el-alert
            title="å…‘æ¢ç»“æœ"
            type="success"
            :description="`${form.amount} ${form.fromCurrency} = ${result.toFixed(2)} ${form.toCurrency}`"
            :closable="false"
            show-icon
          />
          <p class="rate-info">
            å½“å‰æ±‡ç‡ï¼š1 {{ form.fromCurrency }} = {{ currentRate }} {{ form.toCurrency }}
          </p>
        </div>

        <!-- æ±‡ç‡è¡¨ -->
        <div class="rates-table" v-if="exchangeRates.length">
          <h3>æœ€æ–°æ±‡ç‡</h3>
          <el-table :data="exchangeRates">
            <el-table-column prop="fromCurrency" label="ä»è´§å¸" width="120" />
            <el-table-column prop="toCurrency" label="åˆ°è´§å¸" width="120" />
            <el-table-column prop="rate" label="æ±‡ç‡" />
            <el-table-column label="æ—¥æœŸ">
              <template #default="s">
                {{ formatDate(s.row.date) }}
              </template>
            </el-table-column>
          </el-table>
        </div>

      </el-card>
    </el-main>
  </el-container>
</template>

<script setup lang="ts">
import { ElMessage } from 'element-plus';
import { computed, onMounted, ref } from 'vue';
import axios from '../axios';

interface ExchangeRate {
  id: number;
  fromCurrency: string;
  toCurrency: string;
  rate: number;
  date: string;
}

const form = ref({
  fromCurrency: 'USD',
  toCurrency: 'CNY',
  amount: 100
});

const exchangeRates = ref<ExchangeRate[]>([]);
const currencies = ref<string[]>([]);
const result = ref<number | null>(null);
const loading = ref(false);

const fetchExchangeRates = async () => {
  loading.value = true;
  try {
    const res = await axios.get('/exchangeRates');
    exchangeRates.value = res.data;

    const cur = new Set<string>();
    exchangeRates.value.forEach(r => {
      cur.add(r.fromCurrency);
      cur.add(r.toCurrency);
    });
    currencies.value = [...cur];
  } catch {
    ElMessage.error("è·å–æ±‡ç‡å¤±è´¥");
  }
  loading.value = false;
};

const calculateResult = () => {
  const rate = exchangeRates.value.find(
    r => r.fromCurrency === form.value.fromCurrency && r.toCurrency === form.value.toCurrency
  );
  result.value = rate ? form.value.amount * rate.rate : null;
};

const currentRate = computed(() => {
  const rate = exchangeRates.value.find(
    r => r.fromCurrency === form.value.fromCurrency && r.toCurrency === form.value.toCurrency
  );
  return rate ? rate.rate : 'N/A';
});

const swapCurrencies = () => {
  [form.value.fromCurrency, form.value.toCurrency] =
    [form.value.toCurrency, form.value.fromCurrency];
  calculateResult();
};

const exchange = () => {
  ElMessage.success("å…‘æ¢æˆåŠŸï¼ˆæ¼”ç¤ºï¼Œæ— åç«¯åŠŸèƒ½ï¼‰");
};

const formatDate = (d: string) => new Date(d).toLocaleString("zh-CN");

onMounted(fetchExchangeRates);
</script>
</file>

<file path="src/views/HomeView.vue">
<template>  
  <el-container class="home-container">  
    <el-main>
      <div class="welcome-section">
        <div class="welcome-content">
          <h1 class="title">ğŸš€ æ¬¢è¿ä½¿ç”¨è“é¼ å…‘æ¢ç³»ç»Ÿ</h1>
          <p class="description">ä¸€ç«™å¼è´§å¸å…‘æ¢ä¸é‡‘èèµ„è®¯å¹³å°</p>
          
          <div class="feature-cards">
            <el-row :gutter="20">
              <el-col :xs="24" :sm="8" class="feature-col">
                <el-card class="feature-card" shadow="hover">
                  <div class="feature-icon">ğŸ’±</div>
                  <h3>å®æ—¶æ±‡ç‡</h3>
                  <p>è·å–æœ€æ–°çš„è´§å¸å…‘æ¢æ±‡ç‡ï¼Œæ”¯æŒå¤šç§è´§å¸å¯¹</p>
                  <el-button type="primary" @click="router.push('/exchange')">å¼€å§‹å…‘æ¢</el-button>
                </el-card>
              </el-col>
              
              <el-col :xs="24" :sm="8" class="feature-col">
                <el-card class="feature-card" shadow="hover">
                  <div class="feature-icon">ğŸ“°</div>
                  <h3>é‡‘èèµ„è®¯</h3>
                  <p>æµè§ˆæœ€æ–°çš„é‡‘èæ–°é—»å’Œå¸‚åœºåˆ†ææ–‡ç« </p>
                  <el-button type="primary" @click="router.push('/news')">é˜…è¯»èµ„è®¯</el-button>
                </el-card>
              </el-col>
              
              <el-col :xs="24" :sm="8" class="feature-col">
                <el-card class="feature-card" shadow="hover">
                  <div class="feature-icon">ğŸ‘¤</div>
                  <h3>ä¸ªäººä¸­å¿ƒ</h3>
                  <p>ç®¡ç†æ‚¨çš„ä¸ªäººä¿¡æ¯å’Œäº¤æ˜“è®°å½•</p>
                  <el-button 
                    type="primary" 
                    @click="authStore.isAuthenticated ? router.push('/profile') : router.push('/login')"
                  >
                    {{ authStore.isAuthenticated ? 'ä¸ªäººä¸­å¿ƒ' : 'ç«‹å³ç™»å½•' }}
                  </el-button>
                </el-card>
              </el-col>
            </el-row>
          </div>

          <!-- çƒ­é—¨æ–‡ç« é¢„è§ˆ -->
          <div class="hot-articles" v-if="hotArticles.length">
            <h2 class="section-title">ğŸ”¥ çƒ­é—¨æ–‡ç« </h2>
            <el-row :gutter="20">
              <el-col 
                v-for="article in hotArticles" 
                :key="article.ID" 
                :xs="24" 
                :sm="8" 
                class="article-col"
              >
                <el-card class="article-preview-card" shadow="hover" @click="viewArticle(article.ID)">
                  <div class="article-preview">
                    <h4>{{ article.Title }}</h4>
                    <p class="article-excerpt">{{ article.Preview }}</p>
                    <div class="article-meta">
                      <span>ğŸ‘ {{ article.LikesCount }}</span>
                      <span>ğŸ‘ {{ article.ViewsCount }}</span>
                    </div>
                  </div>
                </el-card>
              </el-col>
            </el-row>
          </div>

          <!-- å¿«é€Ÿæ“ä½œ -->
          <div class="quick-actions">
            <h2 class="section-title">âš¡ å¿«é€Ÿæ“ä½œ</h2>
            <div class="action-buttons">
              <el-button 
                type="primary" 
                size="large" 
                @click="router.push('/exchange')"
                icon="ShoppingCart"
              >
                è´§å¸å…‘æ¢
              </el-button>
              <el-button 
                type="success" 
                size="large" 
                @click="router.push('/news')"
                icon="Reading"
              >
                æµè§ˆèµ„è®¯
              </el-button>
              <el-button 
                v-if="!authStore.isAuthenticated"
                type="warning" 
                size="large" 
                @click="router.push('/register')"
                icon="User"
              >
                ç«‹å³æ³¨å†Œ
              </el-button>
              <el-button 
                v-if="authStore.user?.role === 'admin'"
                type="danger" 
                size="large" 
                @click="router.push('/admin/users')"
                icon="Setting"
              >
                ç®¡ç†åå°
              </el-button>
            </div>
          </div>
        </div>
      </div>
    </el-main>
  </el-container>  
</template>  
  
<script setup lang="ts">
import { ElMessage } from 'element-plus';
import { onMounted, ref } from 'vue';
import { useRouter } from 'vue-router';
import axios from '../axios';
import { useAuthStore } from '../store/auth';
import type { Article } from "../types/Article";

const router = useRouter();
const authStore = useAuthStore();
const hotArticles = ref<Article[]>([]);

const fetchHotArticles = async () => {
  try {
    const response = await axios.get<Article[]>('/articles/hot');
    hotArticles.value = response.data.slice(0, 3); // åªæ˜¾ç¤ºå‰3ç¯‡
  } catch (error) {
    console.error('Failed to load hot articles:', error);
  }
};

const viewArticle = (id: number) => {
  if (!authStore.isAuthenticated) {
    ElMessage.warning('è¯·å…ˆç™»å½•åå†æŸ¥çœ‹æ–‡ç« ');
    return;
  }
  router.push({ name: 'NewsDetail', params: { id: id.toString() } });
};

onMounted(() => {
  fetchHotArticles();
});
</script>  
  
<style scoped>
.home-container {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height: calc(100vh - 60px);
}

.welcome-section {
  padding: 60px 20px;
}

.welcome-content {
  max-width: 1200px;
  margin: 0 auto;
  text-align: center;
}

.title {
  color: white;
  font-size: 3rem;
  font-weight: bold;
  margin-bottom: 1rem;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
}

.description {
  color: rgba(255, 255, 255, 0.9);
  font-size: 1.5rem;
  margin-bottom: 3rem;
}

.feature-cards {
  margin: 4rem 0;
}

.feature-col {
  margin-bottom: 2rem;
}

.feature-card {
  height: 100%;
  text-align: center;
  transition: transform 0.3s ease;
}

.feature-card:hover {
  transform: translateY(-5px);
}

.feature-icon {
  font-size: 4rem;
  margin-bottom: 1rem;
}

.feature-card h3 {
  margin: 1rem 0;
  color: #333;
}

.feature-card p {
  color: #666;
  margin-bottom: 1.5rem;
  line-height: 1.6;
}

.hot-articles {
  margin: 4rem 0;
  background: white;
  padding: 2rem;
  border-radius: 12px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.1);
}

.section-title {
  text-align: center;
  color: #333;
  margin-bottom: 2rem;
  font-size: 2rem;
}

.article-col {
  margin-bottom: 1.5rem;
}

.article-preview-card {
  height: 100%;
  cursor: pointer;
  transition: all 0.3s ease;
}

.article-preview-card:hover {
  box-shadow: 0 6px 25px rgba(0,0,0,0.15);
  transform: translateY(-2px);
}

.article-preview h4 {
  margin-bottom: 1rem;
  color: #333;
  line-height: 1.4;
  height: 2.8em;
  overflow: hidden;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
}

.article-excerpt {
  color: #666;
  line-height: 1.6;
  height: 4.8em;
  overflow: hidden;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  margin-bottom: 1rem;
}

.article-meta {
  display: flex;
  justify-content: space-between;
  color: #999;
  font-size: 0.9em;
}

.quick-actions {
  margin: 4rem 0;
  background: white;
  padding: 2rem;
  border-radius: 12px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.1);
}

.action-buttons {
  display: flex;
  justify-content: center;
  gap: 1rem;
  flex-wrap: wrap;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
  .title {
    font-size: 2rem;
  }
  
  .description {
    font-size: 1.2rem;
  }
  
  .action-buttons {
    flex-direction: column;
    align-items: center;
  }
  
  .action-buttons .el-button {
    width: 100%;
    max-width: 300px;
  }
}
</style>
</file>

<file path="src/views/NewsDetailView.vue">
<template>
  <el-container class="news-detail-container">
    <el-main>
      <div class="content-wrapper">
        
        <!-- ===== æ–‡ç« å†…å®¹ ===== -->
        <el-card v-if="article" class="article-card">
          <div class="article-header">
            <h1 class="title">{{ article.title }}</h1>

            <div class="meta-row">
              <el-tag size="small" v-if="categoryName">{{ categoryName }}</el-tag>

              <span class="meta-item">
                <el-icon><Calendar /></el-icon>
                {{ formatDate(article.createdAt) }}
              </span>

              <span class="meta-item">
                <el-icon><View /></el-icon>
                {{ article.viewsCount }}
              </span>

              <span class="meta-item">
                <el-icon><Star /></el-icon>
                {{ article.likesCount }}
              </span>
            </div>
          </div>

          <div v-if="article.cover" class="article-cover">
            <el-image :src="article.cover" fit="cover" class="cover-image" />
          </div>

          <el-divider />

          <div class="article-content ql-editor" v-html="article.content"></div>

          <div class="action-bar">
            <el-button :type="hasLiked ? 'primary' : 'default'" circle size="large" @click="likeArticle">
              <el-icon><Pointer /></el-icon>
            </el-button>
            <span class="action-label">ç‚¹èµ</span>

            <el-button :type="isFavorited ? 'warning' : 'default'" circle size="large" @click="toggleFavorite" style="margin-left: 20px;">
              <el-icon><Collection /></el-icon>
            </el-button>
            <span class="action-label">{{ isFavorited ? 'å·²æ”¶è—' : 'æ”¶è—' }}</span>
          </div>
        </el-card>

        <!-- ===== è¯„è®ºåŒº ===== -->
        <el-card class="comments-card">
          <template #header>
            <div class="clearfix">
              <span>è¯„è®º ({{ comments.length }})</span>
            </div>
          </template>

          <!-- è¯„è®ºè¾“å…¥ -->
          <div v-if="authStore.isAuthenticated" class="comment-input-area">
            <el-input
              v-model="newComment"
              type="textarea"
              :rows="3"
              placeholder="å†™ä¸‹ä½ çš„çœ‹æ³•..."
            />
            <div class="comment-submit">
              <el-button type="primary" @click="submitComment(null)">å‘è¡¨è¯„è®º</el-button>
            </div>
          </div>

          <el-alert
            v-else
            title="è¯·ç™»å½•åå‚ä¸è¯„è®º"
            type="info"
            center
            show-icon
            :closable="false"
            style="margin-bottom:20px;"
          />

          <!-- è¯„è®ºåˆ—è¡¨ -->
          <div class="comment-list">
            <div v-for="comment in comments" :key="comment.id" class="comment-item">

              <div class="comment-avatar">
                <el-avatar :size="40">{{ comment.userName?.charAt(0)?.toUpperCase() || 'U' }}</el-avatar>
              </div>

              <div class="comment-body">
                <div class="comment-info">
                  <span class="username">{{ comment.userName }}</span>
                  <span class="timestamp">{{ formatDate(comment.createdAt) }}</span>
                </div>

                <div class="comment-text">
                  <span v-if="comment.parentId" class="reply-tag">
                    å›å¤ @{{ getParentUser(comment.parentId) }}:
                  </span>
                  {{ comment.content }}
                </div>

                <div class="comment-actions">
                  <el-button link size="small" type="primary"
                    @click="toggleReply(comment.id)"
                    v-if="authStore.isAuthenticated">
                    å›å¤
                  </el-button>

                  <el-button link size="small" type="danger"
                    v-if="canDelete(comment)"
                    @click="deleteComment(comment.id)">
                    åˆ é™¤
                  </el-button>
                </div>

                <div v-if="replyBoxId === comment.id" class="reply-box">
                  <el-input v-model="replyContent" size="small" placeholder="å›å¤å†…å®¹..." />
                  <el-button type="primary" size="small" @click="submitComment(comment.id)" style="margin-top:5px;">
                    å‘é€
                  </el-button>
                </div>

              </div>

            </div>
          </div>
        </el-card>

      </div>
    </el-main>
  </el-container>
</template>

<script setup lang="ts">
import { Calendar, Collection, Pointer, Star, View } from "@element-plus/icons-vue";
import { ElMessage } from "element-plus";
import { computed, onMounted, ref } from "vue";
import { useRoute } from "vue-router";
import axios from "../axios";
import { useAuthStore } from "../store/auth";

const route = useRoute();
const authStore = useAuthStore();

const article = ref<any>(null);
const comments = ref<any[]>([]);
const categories = ref<any[]>([]);
const newComment = ref("");
const replyContent = ref("");
const replyBoxId = ref<number | null>(null);

const hasLiked = ref(false);
const isFavorited = ref(false);

const fetchArticle = async () => {
  try {
    const res = await axios.get(`/articles/${route.params.id}`);
    article.value = res.data;

    const catRes = await axios.get("/categories");
    categories.value = catRes.data;
  } catch {
    ElMessage.error("æ–‡ç« åŠ è½½å¤±è´¥");
  }
};

const categoryName = computed(() => {
  if (!article.value) return "";
  const c = categories.value.find((x) => x.id === article.value.categoryId);
  return c?.name || "æœªåˆ†ç±»";
});

const fetchComments = async () => {
  const res = await axios.get(`/articles/${route.params.id}/comments`);
  comments.value = res.data;
};

const getParentUser = (pid: number) => {
  const parent = comments.value.find((c) => c.id === pid);
  return parent?.userName || "";
};

const formatDate = (str: string) => {
  if (!str || str.startsWith("0001")) return "åˆšåˆš";
  return new Date(str).toLocaleString("zh-CN");
};

const submitComment = async (parentId: number | null) => {
  const content = parentId ? replyContent.value : newComment.value;
  if (!content.trim()) return ElMessage.warning("è¯·è¾“å…¥å†…å®¹");

  await axios.post(`/articles/${route.params.id}/comments`, {
    content,
    parentId,
  });

  newComment.value = "";
  replyContent.value = "";
  replyBoxId.value = null;

  fetchComments();
  ElMessage.success("è¯„è®ºæˆåŠŸ");
};

const toggleReply = (id: number) => {
  replyBoxId.value = replyBoxId.value === id ? null : id;
};

const canDelete = (comment: any) => {
  if (!authStore.user) return false;
  return authStore.user.role === "admin" || authStore.user.id === comment.userId;
};

const deleteComment = async (id: number) => {
  await axios.delete(`/comments/${id}`);
  fetchComments();
  ElMessage.success("å·²åˆ é™¤");
};

const likeArticle = async () => {
  if (!authStore.isAuthenticated) return ElMessage.warning("è¯·ç™»å½•");
  await axios.post(`/articles/${route.params.id}/like`);
  article.value.likesCount++;
};

const toggleFavorite = async () => {
  if (!authStore.isAuthenticated) return ElMessage.warning("è¯·ç™»å½•");
  await axios.post(`/articles/${route.params.id}/favorite`);
  isFavorited.value = !isFavorited.value;
};

onMounted(() => {
  fetchArticle();
  fetchComments();
});
</script>

<style scoped>
.news-detail-container { background: #f5f7fa; min-height: calc(100vh - 60px); padding: 20px; }
.content-wrapper { max-width: 800px; margin: 0 auto; }
.article-card { margin-bottom: 20px; border-radius: 8px; }
.title { font-size: 2rem; margin-bottom: 15px; color: #333; }
.meta-row { display: flex; gap: 15px; color: #999; font-size: 0.9rem; align-items: center; margin-bottom: 20px; }
.meta-item { display: flex; align-items: center; gap: 4px; }
.article-cover { margin-bottom: 20px; border-radius: 4px; overflow: hidden; }
.article-content { font-size: 1.1rem; line-height: 1.8; color: #444; min-height: 200px; }
.action-bar { margin-top: 40px; display: flex; justify-content: center; align-items: center; }
.action-label { margin-left: 8px; color: #666; }

.comments-card { border-radius: 8px; }
.comment-item { display: flex; gap: 15px; padding: 15px 0; border-bottom: 1px solid #eee; }
.comment-info { display: flex; justify-content: space-between; margin-bottom: 5px; }
.username { font-weight: bold; color: #333; }
.timestamp { font-size: 0.8rem; color: #999; }
.comment-body { flex: 1; }
.comment-text { color: #555; line-height: 1.5; }
.reply-tag { color: #409EFF; margin-right: 5px; }
.comment-actions { margin-top: 5px; }
.reply-box { margin-top: 10px; background: #f9f9f9; padding: 10px; border-radius: 4px; }
.comment-submit { margin-top: 10px; text-align: right; }
</style>
</file>

<file path="src/views/NewsView.vue">
<template>
  <el-container>
    <el-main>
      <!-- åˆ†ç±»ç­›é€‰å’Œçƒ­é—¨æ–‡ç«  -->
      <div class="filter-section">
        <el-select v-model="categoryFilter" placeholder="é€‰æ‹©åˆ†ç±»" @change="handleCategoryChange">
          <el-option label="å…¨éƒ¨" value="" />
          <el-option v-for="category in categories" :key="category.ID" 
            :label="category.Name" :value="category.ID" />
        </el-select>
        <el-button type="primary" @click="fetchHotArticles">çƒ­é—¨æ–‡ç« </el-button>
      </div>

      <!-- æ–‡ç« åˆ—è¡¨ -->
      <div v-if="articles && articles.length">
        <el-card v-for="article in articles" :key="article.ID" class="article-card">
          <div class="article-header">
            <h2>{{ article.Title }}</h2>
            <span class="article-meta">
              æµè§ˆ: {{ article.ViewsCount }} | ç‚¹èµ: {{ article.LikesCount }}
            </span>
          </div>
          <p class="article-preview">{{ article.Preview }}</p>
          <div class="article-footer">
            <el-button text @click="viewDetail(article.ID)">é˜…è¯»æ›´å¤š</el-button>
            <span class="article-time">{{ formatDate(article.CreatedAt) }}</span>
          </div>
        </el-card>
      </div>
      <div v-else class="no-data">æš‚æ— æ–‡ç« </div>

      <!-- åˆ†é¡µ -->
      <div class="pagination-container">
        <el-pagination
          v-model:current-page="currentPage"
          v-model:page-size="pageSize"
          :page-sizes="[5, 10, 20]"
          :total="total"
          layout="total, sizes, prev, pager, next, jumper"
          @size-change="handleSizeChange"
          @current-change="handleCurrentChange"
        />
      </div>
    </el-main>
  </el-container>
</template>

<script setup lang="ts">
import { ElMessage } from 'element-plus';
import { onMounted, ref, watch } from 'vue';
import { useRouter } from 'vue-router';
import axios from '../axios';
import type { Article, Category } from "../types/Article";

const articles = ref<Article[]>([]);
const categories = ref<Category[]>([]);
const categoryFilter = ref('');
const currentPage = ref(1);
const pageSize = ref(10);
const total = ref(0);
const router = useRouter();

const fetchArticles = async () => {
  try {
    const params: any = {
      page: currentPage.value,
      limit: pageSize.value
    };
    if (categoryFilter.value) {
      params.category = categoryFilter.value;
    }
    const response = await axios.get<{ data: Article[], total: number }>('/articles', { params });
    articles.value = response.data.data;
    total.value = response.data.total;
  } catch (error) {
    console.error('Failed to load articles:', error);
    ElMessage.error('åŠ è½½æ–‡ç« å¤±è´¥');
  }
};

const fetchCategories = async () => {
  try {
    const response = await axios.get<Category[]>('/categories');
    categories.value = response.data;
  } catch (error) {
    console.error('Failed to load categories:', error);
  }
};

const fetchHotArticles = async () => {
  try {
    const response = await axios.get<Article[]>('/articles/hot');
    articles.value = response.data;
    categoryFilter.value = '';
    currentPage.value = 1;
  } catch (error) {
    console.error('Failed to load hot articles:', error);
    ElMessage.error('åŠ è½½çƒ­é—¨æ–‡ç« å¤±è´¥');
  }
};

const handleCategoryChange = () => {
  currentPage.value = 1;
  fetchArticles();
};

const handleSizeChange = (newSize: number) => {
  pageSize.value = newSize;
  currentPage.value = 1;
  fetchArticles();
};

const handleCurrentChange = (newPage: number) => {
  currentPage.value = newPage;
  fetchArticles();
};

const viewDetail = (id: number) => {
  router.push({ name: 'NewsDetail', params: { id: id.toString() } });
};

const formatDate = (dateString?: string) => {
  if (!dateString) return '';
  return new Date(dateString).toLocaleDateString('zh-CN');
};

onMounted(() => {
  fetchArticles();
  fetchCategories();
});

watch([currentPage, pageSize], () => {
  fetchArticles();
});
</script>

<style scoped>
.filter-section {
  margin-bottom: 20px;
  display: flex;
  gap: 10px;
  align-items: center;
}

.article-card {
  margin: 20px 0;
  padding: 20px;
}

.article-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.article-header h2 {
  margin: 0;
  color: #333;
}

.article-meta {
  color: #666;
  font-size: 0.9em;
}

.article-preview {
  color: #555;
  line-height: 1.6;
  margin-bottom: 15px;
}

.article-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.article-time {
  color: #999;
  font-size: 0.8em;
}

.pagination-container {
  margin-top: 20px;
  display: flex;
  justify-content: center;
}

.no-data {
  text-align: center;
  font-size: 1.2em;
  color: #999;
  padding: 40px 0;
}
</style>
</file>

<file path="src/views/ProfileView.vue">
<template>
  <el-container class="profile-container">
    <div class="profile-wrapper">
      <el-tabs type="border-card">
        <el-tab-pane label="ä¸ªäººèµ„æ–™">
          <el-form :model="form" label-width="100px" v-loading="loading" class="profile-form">
             <el-form-item label="ç”¨æˆ·å">
                <el-input v-model="authStore.user!.username" disabled />
             </el-form-item>
             <el-form-item label="èº«ä»½">
                <el-tag :type="authStore.user!.role === 'admin' ? 'danger' : 'success'">
                  {{ authStore.user!.role === 'admin' ? 'ç®¡ç†å‘˜' : 'æ™®é€šç”¨æˆ·' }}
                </el-tag>
             </el-form-item>
             <el-form-item label="æ˜µç§°">
                <el-input v-model="form.nickname" />
             </el-form-item>
             <el-form-item label="é‚®ç®±">
                <el-input v-model="form.email" />
             </el-form-item>
             <el-form-item label="å¤´åƒURL">
                <el-input v-model="form.avatar" />
             </el-form-item>
             <el-form-item label="ä¿®æ”¹å¯†ç ">
                <el-input v-model="form.password" type="password" placeholder="ç•™ç©ºåˆ™ä¸ä¿®æ”¹" />
             </el-form-item>
             <el-form-item>
                <el-button type="primary" @click="handleUpdate">ä¿å­˜</el-button>
             </el-form-item>
          </el-form>
        </el-tab-pane>

        <el-tab-pane label="æˆ‘çš„æ”¶è—">
          <div v-if="favorites.length > 0" class="fav-list">
            <el-card 
              v-for="fav in favorites" 
              :key="fav.ID" 
              class="fav-item" 
              shadow="hover"
            >
              <div class="fav-content" @click="router.push(`/news/${fav.ID}`)">
                <div class="fav-info">
                  <h3>{{ fav.Title }}</h3>
                  <p>{{ fav.Preview }}</p>
                  <span class="fav-date">{{ formatDate(fav.CreatedAt) }}</span>
                </div>
                <div v-if="fav.Cover" class="fav-img">
                   <el-image :src="fav.Cover" fit="cover" />
                </div>
              </div>
            </el-card>
          </div>
          <el-empty v-else description="æš‚æ— æ”¶è—æ–‡ç« " />
        </el-tab-pane>
      </el-tabs>
    </div>
  </el-container>
</template>

<script setup lang="ts">
import { ElMessage } from 'element-plus';
import { onMounted, reactive, ref } from 'vue';
import { useRouter } from 'vue-router';
import axios from '../axios';
import { useAuthStore } from '../store/auth';

const authStore = useAuthStore();
const router = useRouter();

const loading = ref(false);
const favorites = ref<any[]>([]);

const form = reactive({
  nickname: '',
  email: '',
  avatar: '',
  password: '',
});

const initForm = () => {
  if (authStore.user) {
    form.nickname = authStore.user.nickname || '';
    form.email = authStore.user.email || '';
    form.avatar = authStore.user.avatar || '';
    form.password = ''; 
  }
};

const fetchFavorites = async () => {
  try {
    const res = await axios.get('/user/favorites');
    favorites.value = res.data;
  } catch (e: any) {
    ElMessage.error(e.response?.data?.error || 'åŠ è½½æ”¶è—åˆ—è¡¨å¤±è´¥');
  }
};

const handleUpdate = async () => {
  loading.value = true;
  try {
    const payload: any = {
      nickname: form.nickname,
      email: form.email,
      avatar: form.avatar,
    };
    if (form.password) {
      payload.password = form.password;
    }

    await axios.put('/user/profile', payload);
    await authStore.fetchProfile(); // Reload user info
    ElMessage.success('èµ„æ–™æ›´æ–°æˆåŠŸ');
    form.password = ''; // Clear password field after successful update
  } catch (e: any) {
    ElMessage.error(e.response?.data?.error || 'èµ„æ–™æ›´æ–°å¤±è´¥');
  } finally {
    loading.value = false;
  }
};

const formatDate = (dateStr: string) => {
  if (!dateStr || dateStr.startsWith('0001')) return 'N/A';
  return new Date(dateStr).toLocaleDateString('zh-CN');
}

onMounted(async () => {
  if (authStore.isAuthenticated) {
    loading.value = true;
    await authStore.fetchProfile();
    initForm();
    await fetchFavorites(); // Fetch favorites on mount
    loading.value = false;
  }
});
</script>

<style scoped>
.profile-container { display: flex; justify-content: center; padding: 40px 20px; background: #f5f7fa; min-height: 80vh; }
.profile-wrapper { width: 100%; max-width: 800px; }
.profile-form { max-width: 500px; padding: 20px; }

/* My Favorites List Styles */
.fav-list { display: flex; flex-direction: column; gap: 10px; }
.fav-item { margin-bottom: 10px; cursor: pointer; border-radius: 4px; }
.fav-item:hover { background-color: #fcfcfc; }

.fav-content { display: flex; justify-content: space-between; align-items: flex-start; padding: 10px; }
.fav-info { flex: 1; min-width: 0; padding-right: 15px; }

.fav-info h3 { margin: 0 0 8px 0; color: #303133; font-size: 1.1rem; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.fav-info p { color: #909399; font-size: 0.9rem; margin: 0 0 8px 0; line-height: 1.5; height: 3em; overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; }
.fav-date { font-size: 0.8rem; color: #C0C4CC; }

.fav-img { width: 120px; height: 80px; flex-shrink: 0; border-radius: 4px; overflow: hidden; }
.fav-img .el-image { width: 100%; height: 100%; object-fit: cover; }
</style>
</file>

<file path="src/App.vue">
<template>
  <el-container>
    <el-header>
      <el-menu 
        :default-active="activeIndex" 
        class="el-menu-demo" 
        mode="horizontal" 
        :ellipsis="false" 
        @select="handleSelect"
        router
      >
        <el-menu-item index="/" style="font-weight: bold; color: #409EFF;">
          ğŸ’° è“é¼ å…‘æ¢
        </el-menu-item>
        
        <el-menu-item index="/">é¦–é¡µ</el-menu-item>
        <el-menu-item index="/exchange">è´§å¸å…‘æ¢</el-menu-item>
        <el-menu-item index="/news">æ–°é—»èµ„è®¯</el-menu-item>
        
        <el-submenu index="admin" v-if="authStore.user?.role === 'admin'">
          <template #title>
            <el-icon><Setting /></el-icon>
            ç®¡ç†å‘˜
          </template>
          <el-menu-item index="/admin/users">ç”¨æˆ·ç®¡ç†</el-menu-item>
          <el-menu-item index="/admin/articles">æ–‡ç« ç®¡ç†</el-menu-item> </el-submenu>
        
        <div class="flex-grow"></div>
        
        <div class="user-menu" v-if="authStore.isAuthenticated">
          <el-submenu index="user">
            <template #title>
              <el-avatar 
                :size="32" 
                :src="authStore.user?.avatar" 
                style="margin-right: 8px;"
              >
                {{ authStore.user?.username?.charAt(0)?.toUpperCase() || 'U' }}
              </el-avatar>
              {{ authStore.user?.nickname || authStore.user?.username }}
              <el-tag v-if="authStore.user?.role === 'admin'" size="small" type="danger" style="margin-left: 8px;">
                ç®¡ç†å‘˜
              </el-tag>
            </template>
            <el-menu-item index="/profile">ä¸ªäººä¸­å¿ƒ</el-menu-item>
            <el-menu-item index="logout">é€€å‡ºç™»å½•</el-menu-item>
          </el-submenu>
        </div>
        
        <div class="auth-menu" v-else>
          <el-menu-item index="/login">ç™»å½•</el-menu-item>
          <el-menu-item index="/register">æ³¨å†Œ</el-menu-item>
        </div>
      </el-menu>
    </el-header>
    
    <el-main style="min-height: calc(100vh - 60px);">
      <router-view></router-view>
    </el-main>
  </el-container>
</template>

<script setup lang="ts">
import { Setting } from '@element-plus/icons-vue';
import { onMounted, ref, watch } from 'vue';
import { useRoute, useRouter } from 'vue-router';
import { useAuthStore } from './store/auth';

const router = useRouter();
const route = useRoute();
const authStore = useAuthStore();
const activeIndex = ref('/');

// ç›‘å¬è·¯ç”±å˜åŒ–é«˜äº®èœå•
watch(route, (newRoute) => {
  updateActiveIndex(newRoute);
});

// åº”ç”¨åŠ è½½æ—¶ï¼Œå¦‚æœå·²ç™»å½•ä½†æ²¡æœ‰ç”¨æˆ·ä¿¡æ¯ï¼Œå°è¯•è·å–ä¸€æ¬¡
onMounted(() => {
  updateActiveIndex(route);
  if (authStore.isAuthenticated && !authStore.user) {
    authStore.fetchProfile().catch(() => {
      // å¦‚æœè·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥ï¼Œå¯èƒ½æ˜¯tokenè¿‡æœŸï¼Œæ¸…é™¤token
      authStore.logout();
    });
  }
});

const updateActiveIndex = (currentRoute: any) => {
  // å¦‚æœæ˜¯åµŒå¥—è·¯ç”±æˆ–å‚æ•°è·¯ç”±ï¼Œç¡®ä¿é«˜äº®å¯¹åº”çš„ä¸»èœå•
  if (currentRoute.path.startsWith('/admin')) {
    // ä¿æŒ admin å­èœå•é«˜äº®é€»è¾‘ç”± element-plus è‡ªåŠ¨å¤„ç†ï¼Œæˆ–è€…æ‰‹åŠ¨æŒ‡å®š
    activeIndex.value = currentRoute.path;
  } else if (currentRoute.path.startsWith('/news')) {
    activeIndex.value = '/news';
  } else {
    activeIndex.value = currentRoute.path;
  }
};

const handleSelect = (key: string) => {
  if (key === 'logout') {
    authStore.logout();
    router.push({ name: 'Home' });
  } else if (key.startsWith('/')) {
    // è·¯ç”±è·³è½¬ç”± router å±æ€§å¤„ç†
  }
};
</script>

<style scoped>
.el-menu-demo {
  line-height: 60px;
  display: flex;
  align-items: center;
}

.flex-grow {
  flex-grow: 1;
}

.user-menu {
  display: flex;
  align-items: center;
}

.auth-menu {
  display: flex;
}

:deep(.el-menu--horizontal) {
  border-bottom: none;
}

:deep(.el-menu--horizontal > .el-menu-item) {
  border-bottom: 2px solid transparent;
}

:deep(.el-menu--horizontal > .el-menu-item.is-active) {
  border-bottom-color: #409EFF;
}
</style>
</file>

<file path="src/axios.ts">
import axios from 'axios';
import { ElMessage } from 'element-plus';
import { useAuthStore } from './store/auth';

const instance = axios.create({
  baseURL: 'http://localhost:3080/api',
  timeout: 10000,
});

// è¯·æ±‚æ‹¦æˆªå™¨
instance.interceptors.request.use(config => {
  const token = localStorage.getItem('token');
  if (token) {
    config.headers.Authorization = token;
  }
  return config;
}, error => {
  return Promise.reject(error);
});

// å“åº”æ‹¦æˆªå™¨
instance.interceptors.response.use(
  response => {
    return response;
  },
  error => {
    if (error.response?.status === 401) {
      // token è¿‡æœŸæˆ–æ— æ•ˆ
      const authStore = useAuthStore();
      authStore.logout();
      ElMessage.error('ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•');
      window.location.href = '/login';
    } else if (error.response?.status === 403) {
      // æƒé™ä¸è¶³
      ElMessage.error('æƒé™ä¸è¶³ï¼Œæ— æ³•è®¿é—®æ­¤åŠŸèƒ½');
      if (window.location.pathname !== '/') {
        window.location.href = '/';
      }
    } else if (error.response?.status >= 500) {
      ElMessage.error('æœåŠ¡å™¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•');
    } else if (error.code === 'ECONNABORTED') {
      ElMessage.error('è¯·æ±‚è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
    }
    return Promise.reject(error);
  }
);


export default instance;
</file>

<file path="src/main.ts">
import * as ElementPlusIconsVue from '@element-plus/icons-vue';
import ElementPlus from 'element-plus';
import 'element-plus/dist/index.css';
import { createPinia } from 'pinia';
import { createApp } from 'vue';
import App from './App.vue';
import router from './router';

const app = createApp(App);

// æ³¨å†Œæ‰€æœ‰å›¾æ ‡
for (const [key, component] of Object.entries(ElementPlusIconsVue)) {
  app.component(key, component);
}

app.use(createPinia());
app.use(ElementPlus);
app.use(router);
app.mount('#app');
</file>

<file path="src/shims-vue.d.ts">
// client/src/shims-vue.d.ts
declare module '*.vue' {
    import { DefineComponent } from 'vue';
    const component: DefineComponent<{}, {}, any>;
    export default component;
  }
</file>

<file path="src/vite-env.d.ts">
/// <reference types="vite/client" />
</file>

<file path="__VLS_types.d.ts">
// @ts-nocheck

type __VLS_IntrinsicElements = __VLS_PickNotAny<import('vue/jsx-runtime').JSX.IntrinsicElements, __VLS_PickNotAny<JSX.IntrinsicElements, Record<string, any>>>;
type __VLS_Element = __VLS_PickNotAny<import('vue/jsx-runtime').JSX.Element, JSX.Element>;

type __VLS_IsAny<T> = 0 extends 1 & T ? true : false;
type __VLS_PickNotAny<A, B> = __VLS_IsAny<A> extends true ? B : A;

type __VLS_Prettify<T> = { [K in keyof T]: T[K]; } & {};

type __VLS_OmitKeepDiscriminatedUnion<T, K extends keyof any> =
	T extends any
		? Pick<T, Exclude<keyof T, K>>
		: never;

type __VLS_GlobalComponents =
	__VLS_PickNotAny<import('vue').GlobalComponents, {}>
	& __VLS_PickNotAny<import('@vue/runtime-core').GlobalComponents, {}>
	& __VLS_PickNotAny<import('@vue/runtime-dom').GlobalComponents, {}>
	& Pick<typeof import('vue'),
		'Transition'
		| 'TransitionGroup'
		| 'KeepAlive'
		| 'Suspense'
		| 'Teleport'
	>;

declare const __VLS_intrinsicElements: __VLS_IntrinsicElements;

// v-for
declare function __VLS_getVForSourceType(source: number): [number, number, number][];
declare function __VLS_getVForSourceType(source: string): [string, number, number][];
declare function __VLS_getVForSourceType<T extends any[]>(source: T): [
	T[number], // item
	number, // key
	number, // index
][];
declare function __VLS_getVForSourceType<T extends { [Symbol.iterator](): Iterator<any> }>(source: T): [
	T extends { [Symbol.iterator](): Iterator<infer T1> } ? T1 : never, // item 
	number, // key
	undefined, // index
][];
declare function __VLS_getVForSourceType<T>(source: T): [
	T[keyof T], // item
	keyof T, // key
	number, // index
][];

declare function __VLS_getSlotParams<T>(slot: T): Parameters<__VLS_PickNotAny<NonNullable<T>, (...args: any[]) => any>>;
declare function __VLS_getSlotParam<T>(slot: T): Parameters<__VLS_PickNotAny<NonNullable<T>, (...args: any[]) => any>>[0];
declare function __VLS_directiveFunction<T>(dir: T):
	T extends import('vue').ObjectDirective<infer E, infer V> | import('vue').FunctionDirective<infer E, infer V> ? (value: V) => void
	: T;
declare function __VLS_withScope<T, K>(ctx: T, scope: K): ctx is T & K;
declare function __VLS_makeOptional<T>(t: T): { [K in keyof T]?: T[K] };

type __VLS_SelfComponent<N, C> = string extends N ? {} : N extends string ? { [P in N]: C } : {};
type __VLS_WithComponent<N0 extends string, LocalComponents, N1 extends string, N2 extends string, N3 extends string> =
	N1 extends keyof LocalComponents ? N1 extends N0 ? Pick<LocalComponents, N0> : { [K in N0]: LocalComponents[N1] } :
	N2 extends keyof LocalComponents ? N2 extends N0 ? Pick<LocalComponents, N0> : { [K in N0]: LocalComponents[N2] } :
	N3 extends keyof LocalComponents ? N3 extends N0 ? Pick<LocalComponents, N0> : { [K in N0]: LocalComponents[N3] } :
	N1 extends keyof __VLS_GlobalComponents ? N1 extends N0 ? Pick<__VLS_GlobalComponents, N0> : { [K in N0]: __VLS_GlobalComponents[N1] } :
	N2 extends keyof __VLS_GlobalComponents ? N2 extends N0 ? Pick<__VLS_GlobalComponents, N0> : { [K in N0]: __VLS_GlobalComponents[N2] } :
	N3 extends keyof __VLS_GlobalComponents ? N3 extends N0 ? Pick<__VLS_GlobalComponents, N0> : { [K in N0]: __VLS_GlobalComponents[N3] } :
	{ [K in N0]: unknown }

type __VLS_FillingEventArg_ParametersLength<E extends (...args: any) => any> = __VLS_IsAny<Parameters<E>> extends true ? -1 : Parameters<E>['length'];
type __VLS_FillingEventArg<E> = E extends (...args: any) => any ? __VLS_FillingEventArg_ParametersLength<E> extends 0 ? ($event?: undefined) => ReturnType<E> : E : E;
declare function __VLS_asFunctionalComponent<T, K = T extends new (...args: any) => any ? InstanceType<T> : unknown>(t: T, instance?: K):
	T extends new (...args: any) => any
	? (props: (K extends { $props: infer Props } ? Props : any) & Record<string, unknown>, ctx?: {
		attrs?: any,
		slots?: K extends { $slots: infer Slots } ? Slots : any,
		emit?: K extends { $emit: infer Emit } ? Emit : any
	}) => __VLS_Element & { __ctx?: typeof ctx & { props?: typeof props; expose?(exposed: K): void; } }
	: T extends () => any ? (props: {}, ctx?: any) => ReturnType<T>
	: T extends (...args: any) => any ? T
	: (_: {} & Record<string, unknown>, ctx?: any) => { __ctx?: { attrs?: any, expose?: any, slots?: any, emit?: any, props?: {} & Record<string, unknown> } };
declare function __VLS_elementAsFunctionalComponent<T>(t: T): (_: T & Record<string, unknown>, ctx?: any) => { __ctx?: { attrs?: any, expose?: any, slots?: any, emit?: any, props?: T & Record<string, unknown> } };
declare function __VLS_functionalComponentArgsRest<T extends (...args: any) => any>(t: T): Parameters<T>['length'] extends 2 ? [any] : [];
declare function __VLS_pickEvent<E1, E2>(emitEvent: E1, propEvent: E2): __VLS_FillingEventArg<
	__VLS_PickNotAny<
		__VLS_AsFunctionOrAny<E2>,
		__VLS_AsFunctionOrAny<E1>
	>
> | undefined;
declare function __VLS_pickFunctionalComponentCtx<T, K>(comp: T, compInstance: K): __VLS_PickNotAny<
	'__ctx' extends keyof __VLS_PickNotAny<K, {}> ? K extends { __ctx?: infer Ctx } ? Ctx : never : any
	, T extends (props: any, ctx: infer Ctx) => any ? Ctx : any
>;
type __VLS_FunctionalComponentProps<T, K> =
	'__ctx' extends keyof __VLS_PickNotAny<K, {}> ? K extends { __ctx?: { props?: infer P } } ? NonNullable<P> : never
	: T extends (props: infer P, ...args: any) => any ? P :
	{};
type __VLS_AsFunctionOrAny<F> = unknown extends F ? any : ((...args: any) => any) extends F ? F : any;

declare function __VLS_normalizeSlot<S>(s: S): S extends () => infer R ? (props: {}) => R : S;

/**
 * emit
 */
// fix https://github.com/vuejs/language-tools/issues/926
type __VLS_UnionToIntersection<U> = (U extends unknown ? (arg: U) => unknown : never) extends ((arg: infer P) => unknown) ? P : never;
type __VLS_OverloadUnionInner<T, U = unknown> = U & T extends (...args: infer A) => infer R
	? U extends T
	? never
	: __VLS_OverloadUnionInner<T, Pick<T, keyof T> & U & ((...args: A) => R)> | ((...args: A) => R)
	: never;
type __VLS_OverloadUnion<T> = Exclude<
	__VLS_OverloadUnionInner<(() => never) & T>,
	T extends () => never ? never : () => never
>;
type __VLS_ConstructorOverloads<T> = __VLS_OverloadUnion<T> extends infer F
	? F extends (event: infer E, ...args: infer A) => any
	? { [K in E & string]: (...args: A) => void; }
	: never
	: never;
type __VLS_NormalizeEmits<T> = __VLS_Prettify<
	__VLS_UnionToIntersection<
		__VLS_ConstructorOverloads<T> & {
			[K in keyof T]: T[K] extends any[] ? { (...args: T[K]): void } : never
		}
	>
>;
</file>

<file path="index.html">
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ExchangeApp</title>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
</file>

<file path="package.json">
{
  "name": "exchangeappdemo",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vue-tsc && vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "axios": "^1.7.3",
    "element-plus": "^2.7.4",
    "pinia": "^2.1.7",
    "router": "^1.3.8",
    "vant": "^4.9.0",
    "vue": "^3.4.21",
    "vue-router": "^4.3.2"
  },
  "devDependencies": {
    "@types/axios": "^0.14.0",
    "@types/node": "^20.12.13",
    "@types/vue-router": "^2.0.0",
    "@typescript-eslint/eslint-plugin": "^7.11.0",
    "@typescript-eslint/parser": "^7.11.0",
    "@vitejs/plugin-vue": "^5.0.4",
    "@vue/cli-plugin-typescript": "^5.0.8",
    "@vue/eslint-config-typescript": "^13.0.0",
    "typescript": "^5.2.2",
    "vite": "^5.4.0",
    "vue-tsc": "^2.0.6"
  },
  "main": "index.js",
  "author": "",
  "license": "ISC",
  "description": ""
}
</file>

<file path="tsconfig.json">
{
  "compilerOptions": {
    "target": "esnext",
    "module": "esnext",
    "strict": true,
    "jsx": "preserve",
    "moduleResolution": "node",
    "resolveJsonModule": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"]
    },
    "types": ["node", "vite/client"]
  },
  "include": ["src/**/*.ts", "src/**/*.d.ts", "src/**/*.tsx", "src/**/*.vue"]
}
</file>

<file path="tsconfig.node.json">
{
  "compilerOptions": {
    "composite": true,
    "skipLibCheck": true,
    "module": "ESNext",
    "moduleResolution": "bundler",
    "allowSyntheticDefaultImports": true,
    "strict": true
  },
  "include": ["vite.config.ts"]
}
</file>

<file path="vite.config.ts">
import { defineConfig } from 'vite';
import vue from '@vitejs/plugin-vue';
import { resolve } from 'path';

// https://vitejs.dev/config/
export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: {
      '@': resolve(__dirname, 'src')
    }
  },
  server: {
    port: 5173,
    proxy: {
      '/api': {
        target: 'http://localhost:3080',
        changeOrigin: true,
        secure: false,
        rewrite: (path) => path.replace(/^\/api/, '/api')
      }
    }
  },
  build: {
    outDir: 'dist',
    sourcemap: false,
    chunkSizeWarningLimit: 1600
  }
});
</file>

</files>
